<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>GeoGebra 固定範囲・スマホ縦長</title>

<style>
  /* 画面をフルで使うレイアウト */
  html,body{margin:0;height:100%;}
  /* 縦長コンテナ：幅100%・高さ90%・中央寄せ   */
  #ggb-box{
    width:100%;
    height:90vh;
    max-height:900px;      /* 好みで上限 */
    margin:0 auto;
  }
</style>

<!-- ggbOnInit を先に宣言 -->
<script>
  let ggbApplet;
  const X_MIN = -0.5, X_MAX = 7,  Y_MIN = -7, Y_MAX = 7;
  const RATIO  = (Y_MAX - Y_MIN) / (X_MAX - X_MIN);   // ≒1.867

  function lockView(){
    ggbApplet.setCoordSystem(X_MIN, X_MAX, Y_MIN, Y_MAX);
    /* setAxesRatio(view, ratioX : ratioY)  第1引数 1 → 1番ビュー */
    ggbApplet.setAxesRatio(1, 1, RATIO);
  }

  /* GeoGebra 本体起動後に呼ばれるコールバック */
  function ggbOnInit(){
    lockView();          // ① 即座にロック
    setTimeout(lockView, 250); // ② 自動リサイズ終了後にもう一度ロック
  }
</script>

<!-- GeoGebra JS API -->
<script src="https://www.geogebra.org/apps/deployggb.js"></script>
</head>
<body>

<div id="ggb-box"></div>

<script>
  /* GGBApplet を生成（true で ggbOnInit 有効）*/
  ggbApplet = new GGBApplet({
    material_id: "nkk867we",     // ← ご自身の ID に
    showToolBar:false,
    showMenuBar:false,
    showAlgebraInput:false,
    enableRightClick:false,
    enableShiftDragZoom:false,
    showZoomButtons:false
  }, true);

  /* ページロード後に埋め込み */
  window.addEventListener("load", () => {
    ggbApplet.inject("ggb-box");
  });
</script>

</body>
</html>
